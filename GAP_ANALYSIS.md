# 🎤 みんカラ - 現状と理想のギャップ分析

最終更新: 2025-12-25

---

## 📊 実装状況サマリー

| カテゴリ | 現状 | 理想 | 達成率 |
|---------|------|------|--------|
| 基本機能 | ✅ 完成 | - | 100% |
| リズムゲーム | ✅ 完成 | - | 100% |
| コールシステム | ✅ 完成 | - | 100% |
| リアルタイム同期 | ⚠️ 同一デバイスのみ | 異なるデバイス間 | 50% |
| 音源 | ⚠️ ファイル未確認 | 実際の楽曲 | 30% |
| デプロイ | ❌ ローカルのみ | Vercel公開 | 0% |

---

## ✅ 実装済み機能

### コア機能
- [x] ルーム作成/参加
- [x] 3つの役割（シンガー/バンド/オーディエンス）
- [x] 曲選択（4曲）
- [x] 楽器選択（4種）

### シンガーモード
- [x] 歌詞表示（タイムライン同期）
- [x] 盛り上がりゲージ
- [x] リクエスト受信・表示
- [x] コール受信（ポップアップ）
- [x] カスタムメッセージ受信（ニコニコ風）
- [x] ファンサ完了ボタン

### バンドモード
- [x] リズムゲーム（4段階判定）
- [x] スコア/コンボ表示
- [x] 4方向スワイプコール
- [x] リクエスト送信（30秒クールダウン）
- [x] カスタムメッセージ送信
- [x] MV背景（MP4アップロード）
- [x] 途中停止ボタン
- [x] 振動フィードバック
- [x] スペシャルノートエフェクト

### オーディエンスモード
- [x] ペンライト
- [x] プリセットコール
- [x] ファンサリクエスト
- [x] カスタムメッセージ送信

### リアルタイム同期
- [x] BroadcastChannel API（同一デバイス・タブ間）
- [x] コール同期
- [x] リクエスト同期
- [x] メッセージ同期

### UI/UX
- [x] Glassmorphismデザイン
- [x] Framer Motionアニメーション
- [x] モバイルレスポンシブ

---

## ⚠️ 部分的に実装済み

### 1. リアルタイム同期
| 現状 | 理想 |
|------|------|
| BroadcastChannel API | WebSocket (Socket.IO) |
| 同一デバイス・タブ間のみ | 異なるデバイス間で完全同期 |
| サーバー不要 | WebSocketサーバー必要 |

**必要な作業:**
- Socket.IOサーバー構築
- ルーム管理ロジック
- 接続/切断ハンドリング

### 2. 音源
| 現状 | 理想 |
|------|------|
| public/audio/*.mp3 参照 | 実際の音源ファイル |
| ファイル存在未確認 | 著作権クリアな楽曲 |

**必要な作業:**
- 音源ファイルの用意
- 歌詞タイミングの調整
- 譜面データの調整

### 3. 結果画面
| 現状 | 理想 |
|------|------|
| シンプルなスコア表示 | 詳細統計、グラフ |
| 個人スコアのみ | 全員のスコア比較 |

**必要な作業:**
- スコア詳細（判定内訳）
- 盛り上がりグラフ
- MVP投票

---

## ❌ 未実装機能

### 優先度: 高

| 機能 | 説明 | 工数目安 |
|------|------|---------|
| **WebSocket同期** | 異なるデバイス間のリアルタイム同期 | 1-2日 |
| **Vercelデプロイ** | 公開URL取得 | 1時間 |
| **PWA化** | ホーム画面追加、オフライン対応 | 2-4時間 |
| **実音源追加** | 著作権フリー楽曲の用意 | 要調達 |

### 優先度: 中

| 機能 | 説明 | 工数目安 |
|------|------|---------|
| **決めポーズタイム** | サビ前カウントダウン、全員同期 | 4-8時間 |
| **ウェーブ機能** | 全員でタイミング合わせスワイプ | 8時間 |
| **絵文字リアクション** | 絵文字を画面に飛ばす | 2-4時間 |
| **MVP投票** | 曲終了後の投票 | 4時間 |
| **詳細結果画面** | グラフ、統計、ランキング | 4-8時間 |

### 優先度: 低

| 機能 | 説明 | 工数目安 |
|------|------|---------|
| **デュエットモード** | 2人歌唱対応 | 1日 |
| **YouTube連携** | 楽曲自動取得 | 1-2日 |
| **Capacitor化** | App Store対応 | 2-3日 |
| **AI歌詞生成** | 替え歌自動生成 | 不明 |

---

## 🎯 理想のプロダクト像

### ユーザー体験
```
1. カラオケボックスに複数人で入室
2. 全員がスマホでQRコードをスキャン
3. 役割を選択（シンガー/バンド/オーディエンス）
4. 曲が始まると全員が各自のロールで参加
5. バンドがノートを叩くと盛り上がりゲージが上昇
6. コール＆リクエストがリアルタイムで歌手に届く
7. 歌手がファンサを実行すると会場が盛り上がる
8. 曲終了後、MVPが発表される
9. 「次は誰が歌う？」→ ローテーション
```

### 技術要件
- **WebSocket**: 異なるデバイス間でのリアルタイム同期
- **低遅延**: 100ms以下の同期遅延
- **オフライン対応**: 曲データのキャッシュ
- **マルチプラットフォーム**: Web/iOS/Android

### ビジネス要件
- **App Store公開**: iOS/Android対応
- **カラオケチェーン連携**: DAM/JOYSOUND連携
- **課金モデル**: プレミアム楽曲、カスタムスキン

---

## 📈 ロードマップ

### Phase 1: MVP完成（現在 → 1週間）
- [ ] WebSocket同期
- [ ] 実音源追加
- [ ] Vercelデプロイ
- [ ] PWA化

### Phase 2: 機能拡充（1週間 → 1ヶ月）
- [ ] 決めポーズタイム
- [ ] ウェーブ機能
- [ ] 詳細結果画面
- [ ] MVP投票

### Phase 3: スケール（1ヶ月 → 3ヶ月）
- [ ] Capacitor化
- [ ] YouTube連携
- [ ] スコアランキング
- [ ] ユーザー認証

---

## 📝 技術的負債

| 項目 | 現状 | 理想 |
|------|------|------|
| 状態管理 | 複数ストアが乱立 | 統一されたストア設計 |
| 型定義 | 一部`unknown`使用 | 完全な型安全 |
| エラーハンドリング | console.error | ユーザーフレンドリーなエラー表示 |
| テスト | なし | E2Eテスト、ユニットテスト |
| アクセシビリティ | 最低限 | WCAG 2.1準拠 |

---

## 🏁 結論

### 現状の達成度: **約70%**

**完成している部分:**
- コア機能は全て動作
- UI/UXは高品質
- 同一デバイスでのデモは可能

**不足している部分:**
- 異なるデバイス間の同期（WebSocket）
- 実際の音源ファイル
- 本番デプロイ

**最短で理想に近づける方法:**
1. Vercelデプロイ（1時間）
2. 「開発中」として公開し、同一デバイスでのデモに限定
3. WebSocket対応は後続フェーズで
