# 既知の問題リスト

MinKaraアプリケーションにおける既知の問題とその詳細をまとめたドキュメントです。
問題が追加されるたびにこのファイルを更新してください。

---

## 問題一覧

| ID | カテゴリ | 問題概要 | 優先度 | ステータス |
|----|---------|---------|--------|-----------|
| #1 | 同期 | オンライン参加者数が正確に反映されない | 高 | ✅ 修正済み |
| #2 | 同期 | 予約リストが他の参加者に正しく同期されない | 高 | ✅ 修正済み |
| #3 | UX | 曲予約のUIが非直感的で分かりにくい | 中 | ✅ 修正済み |
| #4 | 機能 | 参加者名の一覧表示がない | 中 | ✅ 修正済み |
| #5 | 機能 | 予約リストの曲が自動で始まらない | 高 | ✅ 修正済み |
| #6 | UX | 役割選択の催促がない | 中 | ✅ 修正済み |
| #7 | UX | 予約ボタンがロビーで目立たない | 中 | ✅ 修正済み |

---

## 問題詳細

### #1: オンライン参加者数が正確に反映されない

- **カテゴリ**: 同期・リアルタイム通信
- **報告日**: 2025-12-31
- **ステータス**: ✅ 修正済み

#### 現象
- 部屋に入った時、参加者が何人参加していて誰がいるのかが分からない
- 右上の「オンライン」マークで人数を判断する仕組みと思われるが、正確な数字が反映されていない
- **部屋作成者側**: 参加者が増えるたびに正しく数が増加する
- **参加者側**: 常に「1 オンライン」と表示され、正確な参加者数が反映されない

#### 修正内容
- `players_sync` イベントを追加し、既存メンバーが新規参加者に自分の情報を送信するように修正

#### 関連コンポーネント
- `src/store/roomStore.ts`

---

### #2: 予約リストが他の参加者に正しく同期されない

- **カテゴリ**: 同期・リアルタイム通信
- **報告日**: 2025-12-31
- **ステータス**: ✅ 修正済み

#### 現象
- ある参加者が曲を予約したにもかかわらず、その情報が他の参加者に正しく反映されない
- 後から参加した人が予約リストを見ると、「Unknown Song」という形でしか表示されない
- 予約した曲名やアーティスト名などの詳細情報が同期されていない

#### 修正内容
- `fetchReservations` で `SONGS` データから曲名をマッピングするように修正

#### 関連コンポーネント
- `src/store/roomStore.ts`
- `src/components/room/ReservationList.tsx`

---

### #3: 曲予約のUIが非直感的で分かりにくい

- **カテゴリ**: UX/UI
- **報告日**: 2025-12-31
- **ステータス**: 未着手

#### 現象
- 曲を予約する行為が非直感的
- 右下に小さく配置されたマイクマークを押して予約するUIが分かりにくい
- ボタン自体が小さすぎて見つけにくい

#### 改善案
- ロビー画面は大きいスペースがあるため、「曲を予約する」という行為をもっと目立たせるべき
- 予約機能をより大きく、分かりやすく表示する
- UX全般の見直しが必要

#### 関連コンポーネント
- `src/app/room/[roomId]/page.tsx`

---

### #4: 参加者名の一覧表示がない

- **カテゴリ**: 機能
- **報告日**: 2025-12-31
- **ステータス**: 未着手

#### 現象
- ロビー画面で「X Online」と人数は表示されるが、具体的に誰が参加しているかが分からない

#### 改善案
- 参加者の名前と役割を一覧で表示するUIを追加

#### 関連コンポーネント
- `src/app/room/[roomId]/page.tsx`

---

### #5: 予約リストの曲が自動で始まらない

- **カテゴリ**: 機能
- **報告日**: 2025-12-31
- **ステータス**: 未着手

#### 現象
- 予約リストの一番上の曲が自動で始まらない
- 手動で開始する必要がある

#### 改善案
- 予約リストの先頭曲を自動的に開始する機能を追加
- 全員が役割を選択したら開始、または一定時間（10秒程度）経過で自動開始

#### 関連コンポーネント
- `src/store/roomStore.ts`
- `src/app/room/[roomId]/page.tsx`

---

### #6: 役割選択の催促がない

- **カテゴリ**: UX
- **報告日**: 2025-12-31
- **ステータス**: 未着手

#### 現象
- シンガー以外のユーザーにバンドや応援の役割選択を促す仕組みがない
- 役割を選択しないまま待機状態になる

#### 改善案
- 曲が予約されたら、シンガー以外のユーザーに役割選択を促すモーダル/通知を表示
- 役割未選択で一定時間経過したらデフォルト役割（例: オーディエンス）で自動開始

#### 関連コンポーネント
- `src/app/room/[roomId]/page.tsx`

---

### #7: 予約ボタンがロビーで目立たない

- **カテゴリ**: UX
- **報告日**: 2025-12-31
- **ステータス**: 未着手

#### 現象
- 右下の小さなマイクボタンだけでは予約機能が分かりにくい
- ロビー画面のスペースが有効活用されていない

#### 改善案
- ロビー画面にもっと大きな「曲を予約する」ボタンを追加
- 分かりやすいUI/ラベルで予約機能へのアクセスを改善

#### 関連コンポーネント
- `src/app/room/[roomId]/page.tsx`

---

## 更新履歴

| 日付 | 更新内容 |
|------|---------|
| 2025-12-31 | 初版作成。問題 #1, #2, #3 を追加 |
| 2025-12-31 | 問題 #1, #2 を修正済みに更新 (`roomStore.ts` の修正) |
| 2025-12-31 | 問題 #4, #5, #6, #7 を追加（参加者名表示、自動開始、役割催促、予約ボタン改善） |
